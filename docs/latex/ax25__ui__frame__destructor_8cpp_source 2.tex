\hypertarget{ax25__ui__frame__destructor_8cpp_source}{}\doxysection{ax25\+\_\+ui\+\_\+frame\+\_\+destructor.\+cpp}
\label{ax25__ui__frame__destructor_8cpp_source}\index{src/tnc\_emulator/ax25\_ui\_frame\_destructor.cpp@{src/tnc\_emulator/ax25\_ui\_frame\_destructor.cpp}}
\mbox{\hyperlink{ax25__ui__frame__destructor_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00002}00002 \textcolor{comment}{// Created by Hayden Roszell on 12/28/21.}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00003}00003 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00005}00005 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{ax25__ui__frame__destructor_8h}{ax25\_ui\_frame\_destructor.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00008}00008 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{helper_8h}{helper.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00010}00010 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::decode\_frame(\textcolor{keyword}{const} std::string \&frame) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00011}00011     SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Found frame: \{\}"{}}, frame);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00013}00013     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != validate\_header(frame)) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00014}00014         spdlog::error(\textcolor{stringliteral}{"{}Frame validation failed"{}});}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00015}00015         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00016}00016     \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00018}00018     \textcolor{keywordtype}{int} crc\_size = 0; \textcolor{comment}{// Usually 16 bits todo when CRC is checked and tests are added including a CRC, subtract it here}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00020}00020     \textcolor{keyword}{auto} resp\_object = \mbox{\hyperlink{classinfo__field_a1ce3f134d88845ab5f7bcd335cf71615}{build\_telemetry\_object}}(frame.substr(32));}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00022}00022     telemetry.push\_back(resp\_object);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00024}00024     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00025}00025 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00027}00027 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_source(\textcolor{keyword}{const} std::string \&source) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00028}00028     \textcolor{keywordflow}{if} (\mbox{\hyperlink{helper_8cpp_a5a3ac476d1cc28f778bdbd954f0bd090}{hex\_to\_ascii}}(source) == \mbox{\hyperlink{namespaceestts_1_1ax25_a474c8355f8269233c2af064bfc917662}{estts::ax25::AX25\_DESTINATION\_ADDRESS}})}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00029}00029         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00030}00030     spdlog::error(\textcolor{stringliteral}{"{}Source: Expected \{\}; Got \{\}"{}}, \mbox{\hyperlink{namespaceestts_1_1ax25_a474c8355f8269233c2af064bfc917662}{estts::ax25::AX25\_DESTINATION\_ADDRESS}}, \mbox{\hyperlink{helper_8cpp_a5a3ac476d1cc28f778bdbd954f0bd090}{hex\_to\_ascii}}(source));}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00031}00031     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00032}00032 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00034}00034 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_destination(\textcolor{keyword}{const} std::string \&dest) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00035}00035     \textcolor{keywordflow}{if} (\mbox{\hyperlink{helper_8cpp_a5a3ac476d1cc28f778bdbd954f0bd090}{hex\_to\_ascii}}(dest) == \mbox{\hyperlink{namespaceestts_1_1ax25_ae4d7c53bd8fa32f51d56f6c8d0da2447}{estts::ax25::AX25\_SOURCE\_ADDRESS}})}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00036}00036         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00037}00037     spdlog::error(\textcolor{stringliteral}{"{}Destination: Expected \{\}; Got \{\}"{}}, \mbox{\hyperlink{namespaceestts_1_1ax25_ae4d7c53bd8fa32f51d56f6c8d0da2447}{estts::ax25::AX25\_SOURCE\_ADDRESS}}, \mbox{\hyperlink{helper_8cpp_a5a3ac476d1cc28f778bdbd954f0bd090}{hex\_to\_ascii}}(dest));}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00038}00038     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00039}00039 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00041}00041 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_ssid0(\textcolor{keyword}{const} std::string \&ssid) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00042}00042     \textcolor{keywordflow}{if} (ssid == \mbox{\hyperlink{namespaceestts_1_1ax25_a92d92b5fb34bc8d778e0865859e818c8}{estts::ax25::AX25\_SSID0}})}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00043}00043         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00044}00044     spdlog::error(\textcolor{stringliteral}{"{}SSID0: Expected \{\}; Got \{\}"{}}, \mbox{\hyperlink{namespaceestts_1_1ax25_a92d92b5fb34bc8d778e0865859e818c8}{estts::ax25::AX25\_SSID0}}, ssid);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00045}00045     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00046}00046 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00048}00048 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_ssid1(\textcolor{keyword}{const} std::string \&ssid) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00049}00049     \textcolor{keywordflow}{if} (ssid == \mbox{\hyperlink{namespaceestts_1_1ax25_a019d8ae9670a756eee8c87d5c77976d6}{estts::ax25::AX25\_SSID1}})}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00050}00050         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00051}00051     spdlog::error(\textcolor{stringliteral}{"{}SSID1: Expected \{\}; Got \{\}"{}}, \mbox{\hyperlink{namespaceestts_1_1ax25_a019d8ae9670a756eee8c87d5c77976d6}{estts::ax25::AX25\_SSID1}}, ssid);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00052}00052     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00053}00053 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00055}00055 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_control(\textcolor{keyword}{const} std::string \&control) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00056}00056     \textcolor{keywordflow}{if} (control == \mbox{\hyperlink{namespaceestts_1_1ax25_a4c2290a6386618a419b950a1a1edac0a}{estts::ax25::AX25\_CONTROL}})}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00057}00057         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00058}00058     spdlog::error(\textcolor{stringliteral}{"{}Control: Expected \{\}; Got \{\}"{}}, \mbox{\hyperlink{namespaceestts_1_1ax25_a4c2290a6386618a419b950a1a1edac0a}{estts::ax25::AX25\_CONTROL}}, control);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00059}00059     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00060}00060 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00062}00062 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_pid(\textcolor{keyword}{const} std::string \&pid) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00063}00063     \textcolor{keywordflow}{if} (pid == \mbox{\hyperlink{namespaceestts_1_1ax25_aa7a7eeae9e8d663ad4585d5d64af10c9}{estts::ax25::AX25\_PID}})}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00064}00064         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00065}00065     spdlog::error(\textcolor{stringliteral}{"{}PID: Expected \{\}; Got \{\}"{}}, \mbox{\hyperlink{namespaceestts_1_1ax25_aa7a7eeae9e8d663ad4585d5d64af10c9}{estts::ax25::AX25\_PID}}, pid);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00066}00066     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00067}00067 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00069}00069 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::check\_crc(\textcolor{keyword}{const} std::string \&frame, \textcolor{keyword}{const} std::string \&crc) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00070}00070     \textcolor{comment}{// TODO check the CRC against the calculated CRC of the entire frame}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00071}00071     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00072}00072 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00074}00074 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::validate\_header(\textcolor{keyword}{const} std::string \&frame) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00075}00075     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != check\_destination(frame.substr(0, 12)))}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00076}00076         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00077}00077     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != check\_ssid0(frame.substr(12, 2)))}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00078}00078         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00079}00079     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != check\_source(frame.substr(14, 12)))}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00080}00080         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00081}00081     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != check\_ssid1(frame.substr(26, 2)))}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00082}00082         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00083}00083     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != check\_control(frame.substr(28, 2)))}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00084}00084         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00085}00085     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != check\_pid(frame.substr(30, 2)))}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00086}00086         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00087}00087     SPDLOG\_TRACE(\textcolor{stringliteral}{"{}Frame header validated. Continuing"{}});}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00088}00088     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00089}00089 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00091}00091 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} ax25\_ui\_frame\_destructor::build\_telemetry\_objects() \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00092}00092     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00093}00093         \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00094}00094             \textcolor{comment}{// First, find the start of the frame using the flag.}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00095}00095             \textcolor{comment}{// Assuming that the frame transmission had no loss, this method should work.}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00096}00096             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} frame\_start\_flag;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00097}00097             \textcolor{keyword}{auto} raw\_length = raw\_frame.length();}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00098}00098             \textcolor{keywordflow}{if} (raw\_length < 1) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00099}00099                 spdlog::error(\textcolor{stringliteral}{"{}Trying to decode empty frame. Exiting"{}});}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00100}00100                 \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00101}00101             \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00102}00102             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < raw\_length; i++) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00103}00103                 \textcolor{keywordflow}{if} (raw\_frame[i] == \mbox{\hyperlink{namespaceestts_1_1ax25_a15c8c32109b55715bcb621186724e0e2}{estts::ax25::AX25\_FLAG}}[0] \&\& raw\_frame[i + 1] == \mbox{\hyperlink{namespaceestts_1_1ax25_a15c8c32109b55715bcb621186724e0e2}{estts::ax25::AX25\_FLAG}}[1]) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00104}00104                     i++;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00105}00105                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00106}00106                     frame\_start\_flag = i;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00107}00107                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00108}00108                 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00109}00109             \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00110}00110 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00111}00111             \textcolor{comment}{// Now, we need to find the end of the frame. We can do this using the flag, and safely assume that if the}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00112}00112             \textcolor{comment}{// trailing flag is missing, the frame is likely corrupted.}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00113}00113             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} frame\_end;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00114}00114             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < raw\_length; i++) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00115}00115                 \textcolor{keywordflow}{if} (i + 1 >= raw\_length) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00116}00116                     SPDLOG\_TRACE(\textcolor{stringliteral}{"{}No more frames found."{}});}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00117}00117                     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00118}00118                 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00119}00119                 \textcolor{keywordflow}{if} (raw\_frame[i] == \mbox{\hyperlink{namespaceestts_1_1ax25_a15c8c32109b55715bcb621186724e0e2}{estts::ax25::AX25\_FLAG}}[0] \&\& raw\_frame[i + 1] == \mbox{\hyperlink{namespaceestts_1_1ax25_a15c8c32109b55715bcb621186724e0e2}{estts::ax25::AX25\_FLAG}}[1]) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00120}00120                     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_1_1ax25_a15c8c32109b55715bcb621186724e0e2}{estts::ax25::AX25\_FLAG}}[1] != raw\_frame[i -\/ 1] \&\& i > 0) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00121}00121                         frame\_end = i;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00122}00122                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00123}00123                     \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00124}00124                 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00125}00125             \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00127}00127             \textcolor{comment}{// Try decoding the frame.}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00128}00128             \textcolor{keyword}{auto} frame = raw\_frame.substr(frame\_start\_flag, frame\_end -\/ frame\_start\_flag);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00129}00129             \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} == decode\_frame(frame)) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00130}00130                 SPDLOG\_TRACE(\textcolor{stringliteral}{"{}Trimming at index \{\} and looking for more frames"{}}, frame\_end);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00131}00131                 raw\_frame.erase(0, frame\_end);}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00132}00132             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00133}00133                 \textcolor{comment}{// Then, find the start of the frame using the src/dest callsigns. This is a failsafe}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00134}00134                 \textcolor{comment}{// method in case the transmission had loss}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00135}00135                 std::stringstream callsign\_and\_ssid;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00136}00136                 \textcolor{comment}{// Remember that we're expecting the satellite to be the source and ground to be the destination}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00137}00137                 callsign\_and\_ssid << \mbox{\hyperlink{helper_8cpp_aa7d5d059ddd12b2db2e3526208ceda7a}{ascii\_to\_hex}}(\mbox{\hyperlink{namespaceestts_1_1ax25_ae4d7c53bd8fa32f51d56f6c8d0da2447}{estts::ax25::AX25\_SOURCE\_ADDRESS}}) << \mbox{\hyperlink{namespaceestts_1_1ax25_a92d92b5fb34bc8d778e0865859e818c8}{estts::ax25::AX25\_SSID0}} <<}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00138}00138                                   \mbox{\hyperlink{helper_8cpp_aa7d5d059ddd12b2db2e3526208ceda7a}{ascii\_to\_hex}}(\mbox{\hyperlink{namespaceestts_1_1ax25_a474c8355f8269233c2af064bfc917662}{estts::ax25::AX25\_DESTINATION\_ADDRESS}}) << \mbox{\hyperlink{namespaceestts_1_1ax25_a019d8ae9670a756eee8c87d5c77976d6}{estts::ax25::AX25\_SSID1}}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00139}00139                                   << std::endl;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00140}00140                 \textcolor{keyword}{auto} temp = raw\_frame.find(callsign\_and\_ssid.str());}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00141}00141                 \textcolor{keyword}{auto} frame\_start\_callsign = (temp != std::string::npos) ? -\/1 : temp;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00142}00142                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00143}00143             \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00144}00144         \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00145}00145     \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00146}00146     \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::exception \&e) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00147}00147         spdlog::error(\textcolor{stringliteral}{"{}Failed to find frame, found exception \{\}"{}}, e.what());}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00148}00148         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00149}00149     \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00150}00150 \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00152}\mbox{\hyperlink{classax25__ui__frame__destructor_a131016a4a11af8cfde54c9d45eb01774}{00152}} std::vector<estts::telemetry\_object *> \mbox{\hyperlink{classax25__ui__frame__destructor_a131016a4a11af8cfde54c9d45eb01774}{ax25\_ui\_frame\_destructor::destruct\_ax25}}() \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00153}00153     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != build\_telemetry\_objects()) \{}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00154}00154         \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00155}00155     \}}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00156}00156     \textcolor{keywordflow}{return} this-\/>telemetry;}
\DoxyCodeLine{\Hypertarget{ax25__ui__frame__destructor_8cpp_source_l00157}00157 \}}

\end{DoxyCode}
