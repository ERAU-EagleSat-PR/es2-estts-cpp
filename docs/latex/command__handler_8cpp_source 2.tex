\hypertarget{command__handler_8cpp_source}{}\doxysection{command\+\_\+handler.\+cpp}
\label{command__handler_8cpp_source}\index{src/fapi/command\_handler.cpp@{src/fapi/command\_handler.cpp}}
\mbox{\hyperlink{command__handler_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00001}00001 \textcolor{comment}{/* Copyright Â© EagleSat II -\/ Embry Riddle Aeronautical University -\/ All rights reserved -\/ 2022 */}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00002}00002 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00003}00003 \textcolor{comment}{// Created by Hayden Roszell on 12/21/21.}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00008}00008 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00009}00009 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00010}00010 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00012}00012 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{command__handler_8h}{command\_handler.h}}"{}}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00014}00014 \textcolor{keyword}{using namespace }std::this\_thread; \textcolor{comment}{// sleep\_for, sleep\_until}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00015}00015 \textcolor{keyword}{using namespace }std::chrono; \textcolor{comment}{// nanoseconds, system\_clock, seconds}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00022}\mbox{\hyperlink{command__handler_8cpp_a01595e996d3900ff16b99c6222017c27}{00022}} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} \mbox{\hyperlink{command__handler_8cpp_a01595e996d3900ff16b99c6222017c27}{validate\_response\_code}}(\textcolor{keywordtype}{int} code) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00023}00023     \textcolor{keywordflow}{if} (code == \mbox{\hyperlink{namespaceestts_1_1estts__response__code_a6489a07bb71b163968645dc44a2a4ec6}{estts::estts\_response\_code::SUCCESS}})}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00024}00024         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a153afd946fd44755081851bd0b61a35b}{estts::ES\_SUCCESS}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00025}00025     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \mbox{\hyperlink{namespaceestts_1_1estts__response__code_af5166701f83c47be3caa8cbba48357d3}{estts::estts\_response\_code::UNRECOGNIZED\_REQUEST}})}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00026}00026         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a049278f9ec59895539e42dff58105629}{estts::ES\_BAD\_OPTION}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00027}00027     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \mbox{\hyperlink{namespaceestts_1_1estts__response__code_aa3a961fce7f3e19d18d2b247183092a6}{estts::estts\_response\_code::OBC\_FAILURE}})}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00028}00028         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ab6180644c0b6190ec64f895f8c2ee5ff}{estts::ES\_SERVER\_ERROR}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00029}00029     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a3055c9d72025c764bc0c2ae6dd01fa30}{estts::ES\_UNINITIALIZED}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00030}00030 \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00032}\mbox{\hyperlink{classcommand__handler_a79a10166c8445fb42a29e936f6758013}{00032}} \mbox{\hyperlink{classcommand__handler_a79a10166c8445fb42a29e936f6758013}{command\_handler::command\_handler}}() \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00033}00033     this-\/>ti = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00034}00034 \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00036}\mbox{\hyperlink{classcommand__handler_af40f3dfc28b78ed071c3008c56ad8173}{00036}} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} \mbox{\hyperlink{classcommand__handler_af40f3dfc28b78ed071c3008c56ad8173}{command\_handler::execute}}(\mbox{\hyperlink{structestts_1_1waiting__command}{estts::waiting\_command}} *command) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00037}00037     \textcolor{keywordflow}{if} (ti == \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00038}00038         SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Transmission interface not initialized. Was init\_command\_handler() called?"{}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00039}00039         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a3055c9d72025c764bc0c2ae6dd01fa30}{estts::ES\_UNINITIALIZED}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00040}00040     \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00041}00041     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00042}00042 \textcolor{comment}{    if (command-\/>command != nullptr \&\& command-\/>frame.empty())}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00043}00043 \textcolor{comment}{        return execute\_obj(command);}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00044}00044 \textcolor{comment}{    else if (command-\/>command == nullptr \&\& !command-\/>frame.empty())}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00045}00045 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00046}00046 \textcolor{comment}{    else \{}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00047}00047 \textcolor{comment}{        SPDLOG\_ERROR("{}Command object not initialized properly. Please see documentation."{});}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00048}00048 \textcolor{comment}{        return estts::ES\_UNINITIALIZED;}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00049}00049 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00050}00050 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00051}00051     \textcolor{keywordflow}{return} execute\_str(command);}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00052}00052 \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00054}00054 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} command\_handler::execute\_str(\mbox{\hyperlink{structestts_1_1waiting__command}{estts::waiting\_command}} *command) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00055}00055     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00056}00056         SPDLOG\_INFO(\textcolor{stringliteral}{"{}Sending command"{}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00057}00057         \textcolor{keywordtype}{bool} retry = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00058}00058         \textcolor{keywordtype}{int} retries = 0;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00059}00059         \textcolor{comment}{// Try to transmit frame}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00060}00060         \textcolor{keywordflow}{while} (ti-\/>\mbox{\hyperlink{classtransmission__interface_abd3531828b03ac77784e239a1305ce33}{transmit}}(command-\/>\mbox{\hyperlink{structestts_1_1waiting__command_ac413dc43defc2fcc4bc9c14239ac19ec}{frame}}) != \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}}) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00061}00061             spdlog::error(\textcolor{stringliteral}{"{}Failed to transmit frame. Waiting \{\} seconds"{}}, \mbox{\hyperlink{namespaceestts_a568f17193f73938b966fd798c4667b2f}{estts::ESTTS\_RETRY\_WAIT\_SEC}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00062}00062             sleep\_until(system\_clock::now() + seconds(\mbox{\hyperlink{namespaceestts_a568f17193f73938b966fd798c4667b2f}{estts::ESTTS\_RETRY\_WAIT\_SEC}}));}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00063}00063             retries++;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00064}00064             \textcolor{keywordflow}{if} (retries > \mbox{\hyperlink{namespaceestts_1_1endurosat_abbb6370e9fa503021672678a72504545}{estts::endurosat::MAX\_RETRIES}}) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00065}00065             SPDLOG\_INFO(\textcolor{stringliteral}{"{}Retrying transmit (\{\}/\{\})"{}}, retries, \mbox{\hyperlink{namespaceestts_a0275154edfe5ca1a425672d4180b622d}{estts::ESTTS\_MAX\_RETRIES}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00066}00066         \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00067}00067         \textcolor{comment}{// If we got this far,}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00068}00068         SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Successfully transmitted command"{}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00069}00069     \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00070}00070     \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::exception \&e) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00071}00071         \textcolor{comment}{// TODO catch exceptions \& do something smart with them}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00072}00072         spdlog::error(\textcolor{stringliteral}{"{}We failed somewhere"{}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00073}00073         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00074}00074     \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00076}00076     SPDLOG\_INFO(\textcolor{stringliteral}{"{}Waiting for a response from EagleSat II"{}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00077}00077     sleep\_until(system\_clock::now() + milliseconds (100));}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00078}00078     \textcolor{keyword}{auto} telem = ti-\/>\mbox{\hyperlink{classtransmission__interface_aec2a512e3525ce9a55ff911a098ba8f5}{receive}}();}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00079}00079     \textcolor{keywordflow}{if} (telem.empty())}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00080}00080         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00081}00081     SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Got response from EagleSat II"{}});}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00083}00083     \textcolor{comment}{// todo there are likely error cases here that aren't accounted for. Find \& fix them}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00085}00085     \textcolor{keywordflow}{if} (command-\/>\mbox{\hyperlink{structestts_1_1waiting__command_a74d83b4c671df63cb17b44b84f7e6849}{str\_callback}} != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00086}00086         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != command-\/>\mbox{\hyperlink{structestts_1_1waiting__command_a74d83b4c671df63cb17b44b84f7e6849}{str\_callback}}(telem))}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00087}00087             \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00089}00089     \textcolor{keyword}{auto} temp\_completed = \textcolor{keyword}{new} completed;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00090}00090     temp\_completed-\/>serial\_number = command-\/>\mbox{\hyperlink{structestts_1_1waiting__command_a51746d315d956bcf288bc6275cb384bf}{serial\_number}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00091}00091     temp\_completed-\/>response\_code = \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00092}00092     \mbox{\hyperlink{classcommand__handler_ab8759a552e07c52e542cf4ad7a0a2e9d}{completed\_cache}}.push\_back(temp\_completed);}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00094}00094     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00095}00095 \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00097}00097 \mbox{\hyperlink{classcommand__handler_a230996dd388eb9e4eb7361806766b3fc}{command\_handler::\string~command\_handler}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00099}\mbox{\hyperlink{classcommand__handler_a8552cb1b015187a6d2cc2b11c37ec32c}{00099}} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} \mbox{\hyperlink{classcommand__handler_a8552cb1b015187a6d2cc2b11c37ec32c}{command\_handler::init\_command\_handler}}(\mbox{\hyperlink{classtransmission__interface}{transmission\_interface}} *ti) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00100}00100     this-\/>ti = ti;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00101}00101     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00102}00102 \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00103}00103 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00104}00104 \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19}{estts::Status}} command\_handler::map\_telemetry\_to\_dispatched(\textcolor{keyword}{const} std::vector<estts::telemetry\_object *> \&telem) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00105}00105     \textcolor{comment}{// This function requires some intelligence. The basic premise is that the decoded telemetry objects}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00106}00106     \textcolor{comment}{// need to be mapped back to their associated dispatched command objects. There are a couple of ways we}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00107}00107     \textcolor{comment}{// can handle this. For this version, we're just going to handle each response individually and in real-\/time.}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00109}00109     \textcolor{keywordflow}{while} (!\mbox{\hyperlink{classcommand__handler_adab73c65f8e8be7654d8c34414ac48bc}{dispatched}}.empty()) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00110}00110         \textcolor{keyword}{auto} current = \mbox{\hyperlink{classcommand__handler_adab73c65f8e8be7654d8c34414ac48bc}{dispatched}}.back();}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00111}00111         \textcolor{keyword}{auto} command\_id = current-\/>command-\/>commandID;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00112}00112         \textcolor{keyword}{auto} command\_address = current-\/>command-\/>address;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00113}00113         std::vector<estts::telemetry\_object *> temp\_telem;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00114}00114         \textcolor{keywordtype}{bool} associated\_frame\_found;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00115}00115         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} j : telem) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00116}00116             \textcolor{keywordflow}{if} (command\_id == j-\/>commandID \&\& command\_address == j-\/>address) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00117}00117                 \textcolor{comment}{// We have a match!}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00118}00118                 associated\_frame\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00119}00119                 temp\_telem.push\_back(j);}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00120}00120             \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00121}00121         \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00122}00122         \textcolor{keywordflow}{if} (associated\_frame\_found) \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00123}00123             current-\/>telem\_obj = temp\_telem;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00124}00124             current-\/>response\_code = \mbox{\hyperlink{command__handler_8cpp_a01595e996d3900ff16b99c6222017c27}{validate\_response\_code}}(temp\_telem[0]-\/>response\_code);}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00125}00125             \textcolor{keywordflow}{if} (current-\/>obj\_callback != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00126}00126                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}} != current-\/>obj\_callback(current-\/>telem\_obj)) \textcolor{comment}{// Call the obj\_callback with the telemetry object}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00127}00127                     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00128}00128             \textcolor{comment}{// Todo this shoudn't return, it should schedule a new retry, or at least notify something that can retry}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00130}00130             \textcolor{keyword}{auto} temp\_completed = \textcolor{keyword}{new} completed;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00131}00131             temp\_completed-\/>serial\_number = current-\/>serial\_number;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00132}00132             temp\_completed-\/>response\_code = current-\/>response\_code;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00133}00133             \mbox{\hyperlink{classcommand__handler_ab8759a552e07c52e542cf4ad7a0a2e9d}{completed\_cache}}.push\_back(temp\_completed);}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00134}00134         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00135}00135             SPDLOG\_WARN(\textcolor{stringliteral}{"{}Didn't receive a telemetry response for command with SN \{\}"{}}, current-\/>serial\_number);}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00136}00136             current-\/>response\_code = \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19ad9e17c123bd7c5006fb1dec94b598096}{estts::ES\_UNSUCCESSFUL}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00137}00137         \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00138}00138         \textcolor{keyword}{delete} current;}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00139}00139         \mbox{\hyperlink{classcommand__handler_adab73c65f8e8be7654d8c34414ac48bc}{dispatched}}.pop\_back();}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00140}00140     \}}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00142}00142     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespaceestts_a4d1093fd217ec6fa562591a253b35c19a7f25d747775c07a8a84d86ed4f148a95}{estts::ES\_OK}};}
\DoxyCodeLine{\Hypertarget{command__handler_8cpp_source_l00143}00143 \}}

\end{DoxyCode}
